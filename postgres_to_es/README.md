# ETL (Extract-Transform-Load) –ø—Ä–æ—Ü–µ—Å—Å

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã 3 ETL –ø—Ä–æ—Ü–µ—Å—Å–∞ –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –∏–Ω–¥–µ–∫—Å–æ–≤ [movies](https://github.com/192117/admin_panel/blob/master/postgres_to_es/movies_schema.json)üíæ, 
[persons](https://github.com/192117/admin_panel/blob/master/postgres_to_es/persons_schema.json)üíæ –∏ [genres](https://github.com/192117/admin_panel/blob/master/postgres_to_es/genres_schema.json)üíæ

## –¢–µ—Å—Ç—ã –¥–ª—è movies

[Postman-—Ç–µ—Å—Ç—ã](https://code.s3.yandex.net/middle-python/learning-materials/ETLTests-2.json)üíæ

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:

- –≤–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å –ø–æ–º–æ—â—å—é `pydantic`;
- –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ —Ç–∏–ø–æ–≤;
- –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –º–æ–¥—É–ª—å `logging` –∏–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ Python;
- –¥–ª—è –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ–≥–æ –ø–µ—Ä–µ–Ω–æ—Å–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ Postgres –≤ Elasticsearch –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏ —Ç–µ—Ö–Ω–∏–∫—É backoff, 
—á—Ç–æ–±—ã ETL –ø—Ä–æ—Ü–µ—Å—Å –Ω–µ –º–µ—à–∞–ª –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—é –ë–î.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ ETL 

![–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ ETL-–ø–∞–π–ø–ª–∞–π–Ω–∞](ETL_–ø–∞–π–ø–ª–∞–π–Ω–∞.png)

_Extract –¥–æ–ª–∂–µ–Ω:_
- —á–∏—Ç–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–∞—á–∫–∞–º–∏;
- —Å–ø–æ–∫–æ–π–Ω–æ –ø–µ—Ä–µ–∂–∏–≤–∞—Ç—å –ø–∞–¥–µ–Ω–∏–µ PostgreSQL;
- –Ω–∞—á–∏–Ω–∞—Ç—å —á–∏—Ç–∞—Ç—å —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–π –∑–∞–ø–∏—Å–∏.

_Transform –¥–æ–ª–∂–µ–Ω:_
- –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Å—ã—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ PostgreSQL –∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤—ã–≤–∞—Ç—å –≤ —Ñ–æ—Ä–º–∞—Ç, –ø—Ä–∏–≥–æ–¥–Ω—ã–π –¥–ª—è –∑–∞–ø–∏—Å–∏ Elasticsearch.

_Load –¥–æ–ª–∂–µ–Ω:_
- –∑–∞–≥—Ä—É–∂–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–∞—á–∫–∞–º–∏;
- –±–µ–∑ –ø–æ—Ç–µ—Ä—å –ø–µ—Ä–µ–∂–∏–≤–∞—Ç—å –ø–∞–¥–µ–Ω–∏–µ Elasticsearch;
- –ø—Ä–∏–Ω–∏–º–∞—Ç—å/—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–µ, –∫–æ—Ç–æ—Ä–æ–µ –±—É–¥–µ—Ç —Å—á–∏—Ç–∞—Ç—å—Å—è id –≤ Elasticsearch.

_ETL Process –¥–æ–ª–∂–µ–Ω:_
- –∑–∞–ø—É—Å–∫–∞—Ç—å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã.

## –†–∞–±–æ—Ç–∞ —Å —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º

–î–ª—è —Ä–∞–±–æ—Ç—ã ETL –Ω—É–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã, —á—Ç–æ–±—ã –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏—è—Ö –Ω–µ –Ω–∞—á–∏–Ω–∞—Ç—å –∑–∞–≥—Ä—É–∂–∞—Ç—å –≤—Å—ë —Å–Ω–∞—á–∞–ª–∞. 

![–ú–µ—Ö–∞–Ω–∏–∑–º —Å–æ—Å—Ç–æ—è–Ω–∏–π –≤ ETL-–ø—Ä–æ—Ü–µ—Å—Å–∞—Ö](state.png)